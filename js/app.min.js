$(function (){
    $(window).scroll(function(){
       if ($(this).scrollTop() > 100) {
        $('.menu-principal').addClass("bgcolor");
		$(".menu-principal").removeClass("bgcolorlight");
       } else {
        $(".menu-principal").removeClass("bgcolor");
		$('.menu-principal').addClass("bgcolorlight");
       }
    });
});

function compruebaAceptaCookies() {
    if(localStorage.aceptaCookies != 'true'){
      cajacookies.style.display = 'flex';
    }
}
  
function aceptarCookies() {
    localStorage.aceptaCookies = 'true';
    cajacookies.style.display = 'none';
}
  
$(document).ready(function () {
    compruebaAceptaCookies();
});


const colorsBtn = document.querySelector("#change-colors-btn");
const containerColors = document.querySelector(".container-change-colors");
const cambiarFondo = document.querySelector(".cambiar-fondo");
const cambiarTexto = document.querySelector(".cambiar-texto");
const btnBackground = document.querySelector('#btn-change-background');
const popupBackground = document.querySelector('.popup-background');
const closePopup = document.querySelector('.popup-close');
const btnText = document.querySelector('#btn-change-text');
const popupText = document.querySelector('.popup-text');

window.onload = function(){
    containerColors.style.display = 'none';
}

colorsBtn.addEventListener('click', () => {
    containerColors.style.display = 'block';
	popupBackground.style.display = 'block';
	popupText.style.display = 'none';
	cambiarFondo.classList.add("selected");
	cambiarTexto.classList.remove("selected");
});
 
closePopup.addEventListener('click', () => {
    containerColors.style.display = 'none';
});

cambiarFondo.addEventListener('click', () => {
    popupBackground.style.display = 'block';
	popupText.style.display = 'none';
	cambiarFondo.classList.add("selected");
	cambiarTexto.classList.remove("selected");

});

cambiarTexto.addEventListener('click', () => {
    popupBackground.style.display = 'none';
	popupText.style.display = 'block';
	cambiarTexto.classList.add("selected");
	cambiarFondo.classList.remove("selected");
});


function applyInitialTheme () {
    const themeTxt = window.sessionStorage.getItem("site-theme-txt")
    const themeBg = window.sessionStorage.getItem("site-theme-bg")
    if (themeTxt !== null) {
        const htmlTagTxt = document.querySelector("html");
        htmlTagTxt.setAttribute("data-theme-txt", themeTxt);
    }
    if (themeBg !== null) {
        const htmlTagBg = document.querySelector("html");
        htmlTagBg.setAttribute("data-theme-bg", themeBg);
    }
}

applyInitialTheme();

const colorOptions = document.querySelectorAll(".change-color-option");
colorOptions.forEach(colorOption => {
	colorOption.addEventListener('click', e => {
		changeTheme(colorOption.id);
	})
});

function changeTheme (color) {
    const htmlTag = document.querySelector("html");
	var tipo = "quitar";
	if(color == "white-txt" || color == "black-txt" || color == "red-txt" || color == "blue-txt"){
		var tipo = "txt";
		if (htmlTag.hasAttribute('data-theme-txt')) {
			htmlTag.removeAttribute('data-theme-txt')
			window.sessionStorage.removeItem("site-theme-txt");
		}
	}else{
		if(color == "white-bg" || color == "black-bg" || color == "red-bg" || color == "blue-bg"){
			var tipo = "bg";
			if (htmlTag.hasAttribute('data-theme-bg')) {
				htmlTag.removeAttribute('data-theme-bg')
				window.sessionStorage.removeItem("site-theme-bg");
			}
		}else if(color=="remove-colors"){
			if (htmlTag.hasAttribute('data-theme-bg')) {
				htmlTag.removeAttribute('data-theme-bg')
				window.sessionStorage.removeItem("site-theme-bg");
			}
			if (htmlTag.hasAttribute('data-theme-txt')) {
				htmlTag.removeAttribute('data-theme-txt')
				window.sessionStorage.removeItem("site-theme-txt");
			}
		}
	}
    
	if(tipo == "txt"){
		htmlTag.setAttribute('data-theme-txt', color)
		window.sessionStorage.setItem("site-theme-txt", color)
	}else if (tipo == "bg"){
		htmlTag.setAttribute('data-theme-bg', color)
		window.sessionStorage.setItem("site-theme-bg", color)
	}
}